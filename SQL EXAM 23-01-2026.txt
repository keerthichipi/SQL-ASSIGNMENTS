1)SELECT *
FROM emp
WHERE sal = (
    SELECT MIN(sal)
    FROM emp
    WHERE sal > (
        SELECT MIN(sal)
        FROM emp
        WHERE sal > (
            SELECT MIN(sal)
            FROM emp
        )
    )
);

2)SELECT *
FROM emp
WHERE sal > (SELECT AVG(sal) FROM emp);


3)SELECT d.*
FROM dept d
JOIN emp e ON e.deptno = d.deptno
WHERE d.loc = 'NEW YORK';


4)SELECT d.loc
FROM emp e
JOIN dept d ON e.deptno = d.deptno
WHERE e.sal = (
    SELECT MIN(sal)
    FROM emp
    WHERE sal > (
        SELECT MIN(sal)
        FROM emp
        WHERE sal > (
            SELECT MIN(sal)
            FROM emp
        )
    )
);


5)SELECT *
FROM emp
WHERE job <> (SELECT job FROM emp WHERE ename = 'SCOTT')
AND sal > (SELECT sal FROM emp WHERE ename = 'ALLEN');

 6)SELECT d.dname
FROM dept d
JOIN emp e ON d.deptno = e.deptno
WHERE e.job = 'SALESMAN'
GROUP BY d.dname
HAVING COUNT(*) >= 3;


7)SELECT e.*
FROM emp e
JOIN dept d ON e.deptno = d.deptno
WHERE d.dname LIKE '%S';


8)SELECT d.dname
FROM dept d
JOIN emp e ON d.deptno = e.deptno
WHERE e.comm = (SELECT MAX(comm) FROM emp);

9)SELECT e.ename, e.job, d.loc
FROM emp e
JOIN dept d ON e.deptno = d.deptno
WHERE e.job = 'MANAGER'
AND d.loc = 'CHICAGO';


10)SELECT e.ename, d.dname
FROM emp e
JOIN dept d ON e.deptno = d.deptno
WHERE d.dname IN ('SALES', 'RESEARCH')
AND e.empno IN (
    SELECT mgr
    FROM emp
    GROUP BY mgr
    HAVING COUNT(*) >= 2
);


11)SELECT deptno, job, SUM(sal) AS total_sal
FROM emp
GROUP BY deptno, job
HAVING deptno IN (10, 20)
AND SUM(sal) < 10000;


12)SELECT e.ename, e.job, m.ename AS mgr_name, m.job AS mgr_job
FROM emp e
JOIN emp m ON e.mgr = m.empno
WHERE e.job = m.job;


13)SELECT d.dname, e.ename, e.sal, d.loc
FROM emp e
JOIN dept d ON e.deptno = d.deptno
WHERE e.sal IN (
    SELECT sal
    FROM emp
    GROUP BY sal
    HAVING COUNT(*) > 1
);

14)SELECT e.ename, e.hiredate, m.ename AS mgr_name, m.hiredate AS mgr_hiredate
FROM emp e
JOIN emp m ON e.mgr = m.empno
WHERE e.hiredate < m.hiredate;


15)SELECT COUNT(*) AS total_employees
FROM emp e
JOIN dept d ON e.deptno = d.deptno
WHERE d.loc = 'NEW YORK';


16)SELECT e.ename, e.sal, m.ename AS mgr_name, m.sal AS mgr_sal
FROM emp e
JOIN emp m ON e.mgr = m.empno
WHERE e.sal > m.sal;


17)SELECT e.ename, e.job, m.ename AS mgr_name, m.job AS mgr_job
FROM emp e
JOIN emp m ON e.mgr = m.empno
WHERE e.job <> m.job;


18)SELECT e.ename, e.hiredate, m.hiredate AS mgr_hiredate
FROM emp e
JOIN emp m ON e.mgr = m.empno
JOIN dept d ON e.deptno = d.deptno
WHERE d.dname = 'ACCOUNTING'
AND m.hiredate < e.hiredate;

19)SELECT e.ename AS emp_name, d1.dname AS emp_dname,
       m.sal AS mgr_sal, d2.dname AS mgr_dname,
       mm.job AS mgr_mgr_job, d3.dname AS mgr_mgr_dname
FROM emp e
JOIN dept d1 ON e.deptno = d1.deptno
JOIN emp m ON e.mgr = m.empno
JOIN dept d2 ON m.deptno = d2.deptno
JOIN emp mm ON m.mgr = mm.empno
JOIN dept d3 ON mm.deptno = d3.deptno
WHERE e.deptno = 10
AND m.job = 'PRESIDENT'
AND mm.sal >= m.sal;

20)SELECT e.ename, e.sal, m.ename AS mgr_name, d.dname AS mgr_dname
FROM emp e
JOIN emp m ON e.mgr = m.empno
JOIN dept d ON m.deptno = d.deptno
WHERE d.loc = 'NEW YORK'
AND m.sal > 3000;


